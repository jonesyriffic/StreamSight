{% extends 'base.html' %}

{% block title %}Upload Documents - StreamSight{% endblock %}

{% block content %}
<div class="container mt-4">
    <div class="card shadow">
        <div class="card-header bg-primary text-white">
            <h2 class="mb-0">Upload Content</h2>
        </div>
        <div class="card-body">
            <ul class="nav nav-tabs" id="uploadTabs" role="tablist">
                <li class="nav-item" role="presentation">
                    <button class="nav-link active" id="pdf-tab" data-bs-toggle="tab" data-bs-target="#pdf-content" type="button" role="tab" aria-controls="pdf-content" aria-selected="true">
                        <i class="bi bi-file-earmark-pdf"></i> PDF Files
                    </button>
                </li>
                <li class="nav-item" role="presentation">
                    <button class="nav-link" id="weblink-tab" data-bs-toggle="tab" data-bs-target="#weblink-content" type="button" role="tab" aria-controls="weblink-content" aria-selected="false">
                        <i class="bi bi-globe"></i> Web Links
                    </button>
                </li>
                <li class="nav-item" role="presentation">
                    <button class="nav-link" id="youtube-tab" data-bs-toggle="tab" data-bs-target="#youtube-content" type="button" role="tab" aria-controls="youtube-content" aria-selected="false">
                        <i class="bi bi-youtube"></i> YouTube Videos
                    </button>
                </li>
            </ul>
            
            <div class="tab-content mt-4" id="uploadTabsContent">
                <!-- PDF Files Upload Tab -->
                <div class="tab-pane fade show active" id="pdf-content" role="tabpanel" aria-labelledby="pdf-tab">
                    <form action="{{ url_for('upload_document') }}" method="post" enctype="multipart/form-data">
                        <input type="hidden" name="content_type" value="pdf">
                        
                        <div class="mb-3">
                            <label for="category" class="form-label">Category</label>
                            <select class="form-select" id="category" name="category" required>
                                {% for category in categories %}
                                <option value="{{ category }}">{{ category }}</option>
                                {% endfor %}
                            </select>
                        </div>
                        
                        <div class="mb-3">
                            <label for="files" class="form-label">Select PDF Documents</label>
                            <input type="file" class="form-control" id="files" name="files" multiple accept=".pdf" required>
                            <div class="form-text">You can select multiple PDF files. Maximum file size: 100MB per file.</div>
                        </div>
                        
                        <div class="d-grid gap-2">
                            <button type="submit" class="btn btn-primary">
                                <i class="bi bi-cloud-upload"></i> Upload PDF Documents
                            </button>
                        </div>
                    </form>
                </div>
                
                <!-- Web Link Tab -->
                <div class="tab-pane fade" id="weblink-content" role="tabpanel" aria-labelledby="weblink-tab">
                    <form action="{{ url_for('upload_document') }}" method="post">
                        <input type="hidden" name="content_type" value="weblink">
                        
                        <div class="mb-3">
                            <label for="weblink-category" class="form-label">Category</label>
                            <select class="form-select" id="weblink-category" name="category" required>
                                {% for category in categories %}
                                <option value="{{ category }}">{{ category }}</option>
                                {% endfor %}
                            </select>
                        </div>
                        
                        <div class="mb-3">
                            <label for="url" class="form-label">Web Page URL</label>
                            <input type="url" class="form-control" id="url" name="url" required
                                   placeholder="https://example.com/article">
                            <div class="form-text">Enter the URL of a web page to extract its content.</div>
                        </div>
                        
                        <div class="d-grid gap-2">
                            <button type="submit" class="btn btn-primary">
                                <i class="bi bi-globe"></i> Add Web Page
                            </button>
                        </div>
                    </form>
                </div>
                
                <!-- YouTube Tab -->
                <div class="tab-pane fade" id="youtube-content" role="tabpanel" aria-labelledby="youtube-tab">
                    <form action="{{ url_for('upload_document') }}" method="post">
                        <input type="hidden" name="content_type" value="youtube">
                        
                        <div class="mb-3">
                            <label for="youtube-category" class="form-label">Category</label>
                            <select class="form-select" id="youtube-category" name="category" required>
                                {% for category in categories %}
                                <option value="{{ category }}">{{ category }}</option>
                                {% endfor %}
                            </select>
                        </div>
                        
                        <div class="mb-3">
                            <label for="youtube-url" class="form-label">YouTube Video URL</label>
                            <input type="url" class="form-control" id="youtube-url" name="url" required
                                   placeholder="https://www.youtube.com/watch?v=XXXX">
                            <div class="form-text">Enter a YouTube video URL to extract its transcript.</div>
                        </div>
                        
                        <div class="d-grid gap-2">
                            <button type="submit" class="btn btn-primary">
                                <i class="bi bi-youtube"></i> Add YouTube Video
                            </button>
                        </div>
                    </form>
                </div>
            </div>
        </div>
        <div class="card-footer">
            <p class="mb-0"><i class="bi bi-info-circle"></i> Note: All content will be processed by AI to generate summaries and insights.</p>
        </div>
    </div>
</div>
{% endblock %}

{% block scripts %}
<script>
document.addEventListener('DOMContentLoaded', function() {
    // Automatically activate tab based on URL hash, if present
    const hash = window.location.hash;
    if (hash && hash.startsWith('#')) {
        const tabId = hash.substring(1) + '-tab';
        const tab = document.getElementById(tabId);
        if (tab) {
            const bsTab = new bootstrap.Tab(tab);
            bsTab.show();
        }
    }
    
    // Update URL hash when tabs are clicked
    const tabs = document.querySelectorAll('[data-bs-toggle="tab"]');
    tabs.forEach(tab => {
        tab.addEventListener('shown.bs.tab', function (event) {
            const id = event.target.id.replace('-tab', '');
            history.replaceState(null, null, '#' + id);
        });
    });
});
</script>
{% endblock %}